---
layout: page
title: "Canonical Values Browser"
permalink: /value-browser/
---

<link rel="stylesheet" href="{{ '/assets/css/values.css' | relative_url }}">

<h1>Explore Canonical Values</h1>

<div id="filters" style="margin-bottom: 2rem;">
  <fieldset style="margin-bottom: 1.5rem;">
    <legend><strong>NRBC Alignment</strong></legend>
    <label><input type="checkbox" value="Normative" class="nrbc-filter"> Normative</label>
    <label><input type="checkbox" value="Regulatory" class="nrbc-filter"> Regulatory</label>
    <label><input type="checkbox" value="Behavioral" class="nrbc-filter"> Behavioral</label>
    <label><input type="checkbox" value="Conceptual" class="nrbc-filter"> Conceptual</label>
  </fieldset>

  <fieldset style="margin-bottom: 1.5rem;">
    <legend><strong>Core Values</strong></legend>
    <label><input type="checkbox" value="Trust" class="core-filter"> Trust</label>
    <label><input type="checkbox" value="Fairness" class="core-filter"> Fairness</label>
    <label><input type="checkbox" value="Transparency" class="core-filter"> Transparency</label>
    <label><input type="checkbox" value="Accountability" class="core-filter"> Accountability</label>
    <label><input type="checkbox" value="Non-Maleficence" class="core-filter"> Non-Maleficence</label>
  </fieldset>

  <fieldset style="margin-bottom: 1.5rem;">
    <legend><strong>Sectors</strong></legend>
    <label><input type="checkbox" value="Healthcare" class="sector-filter"> Healthcare</label>
    <label><input type="checkbox" value="Education" class="sector-filter"> Education</label>
    <label><input type="checkbox" value="Government" class="sector-filter"> Government</label>
    <label><input type="checkbox" value="Technology" class="sector-filter"> Technology</label>
    <label><input type="checkbox" value="Climate" class="sector-filter"> Climate</label>
    <label><input type="checkbox" value="NGO" class="sector-filter"> NGO</label>
    <label><input type="checkbox" value="Global Governance" class="sector-filter"> Global Governance</label>
  </fieldset>

  <div style="margin-bottom: 1.5rem;">
    <label for="searchBox"><strong>Keyword Search:</strong></label><br>
    <input type="text" id="searchBox" placeholder="Search values..." style="width: 100%; padding: 0.5rem; font-size: 1rem;">
  </div>

  <div style="margin-bottom: 1.5rem;">
    <label for="sortSelect"><strong>Sort By:</strong></label><br>
    <select id="sortSelect" style="padding: 0.5rem; font-size: 1rem;">
      <option value="default">Default Order</option>
      <option value="score">Score (High to Low)</option>
      <option value="weight">Weight (High to Low)</option>
      <option value="title">Alphabetical (Aâ€“Z)</option>
    </select>
  </div>

  <div style="margin-bottom: 2rem;">
    <button id="clearFiltersBtn" style="padding: 0.5rem 1rem; font-size: 1rem;">Clear All Filters</button>
    <button id="exportJsonBtn" style="padding: 0.5rem 1rem; font-size: 1rem; margin-left: 1rem;">Export JSON</button>
    <button id="exportCsvBtn" style="padding: 0.5rem 1rem; font-size: 1rem; margin-left: 1rem;">Export CSV</button>
  </div>
</div>

<div id="value-results"></div>

<script>
async function loadValues() {
  const response = await fetch('/assets/data/canonical-values.json');
  let values = await response.json();
  let filtered = [...values];

  const resultsContainer = document.getElementById('value-results');
  const searchBox = document.getElementById('searchBox');
  const sortSelect = document.getElementById('sortSelect');

  function render(data) {
    resultsContainer.innerHTML = '';
    if (data.length === 0) {
      resultsContainer.innerHTML = '<p>No matching values found.</p>';
      return;
    }
    data.forEach(val => {
      const card = document.createElement('div');
      card.className = 'value-card';
      card.innerHTML = `
        <h2>${val.title}</h2>
        <p><strong>NRBC:</strong> ${val.nrbc} | <strong>Core:</strong> ${val.core_values.join(', ')} | <strong>Sectors:</strong> ${val.sectors.join(', ')}</p>
        <p>${val.summary}</p>
        <p><strong>Score:</strong> ${val.score} | <strong>Weight:</strong> ${val.weight}</p>
        <div class="score-bar-container">
          <div class="score-bar" style="width: ${val.score * 45}%"></div>
        </div>
        <p><a href="${val.url}">Read More</a></p>
      `;
      resultsContainer.appendChild(card);
    });
  }

  function applyFiltersAndSort() {
    const nrbcFilters = [...document.querySelectorAll('.nrbc-filter:checked')].map(cb => cb.value);
    const coreFilters = [...document.querySelectorAll('.core-filter:checked')].map(cb => cb.value);
    const sectorFilters = [...document.querySelectorAll('.sector-filter:checked')].map(cb => cb.value);
    const keyword = searchBox.value.toLowerCase().trim();

    filtered = values.filter(val => {
      const nrbcMatch = nrbcFilters.length === 0 || nrbcFilters.includes(val.nrbc);
      const coreMatch = coreFilters.length === 0 || coreFilters.some(tag => val.core_values.includes(tag));
      const sectorMatch = sectorFilters.length === 0 || sectorFilters.some(tag => val.sectors.includes(tag));
      const keywordMatch =
        keyword === '' ||
        val.title.toLowerCase().includes(keyword) ||
        val.summary.toLowerCase().includes(keyword) ||
        val.nrbc.toLowerCase().includes(keyword) ||
        val.core_values.some(cv => cv.toLowerCase().includes(keyword)) ||
        val.sectors.some(sc => sc.toLowerCase().includes(keyword));
      return nrbcMatch && coreMatch && sectorMatch && keywordMatch;
    });

    const sortOption = sortSelect.value;
    if (sortOption === 'score') {
      filtered.sort((a, b) => b.score - a.score);
    } else if (sortOption === 'weight') {
      filtered.sort((a, b) => b.weight - a.weight);
    } else if (sortOption === 'title') {
      filtered.sort((a, b) => a.title.localeCompare(b.title));
    }

    render(filtered);
  }

  document.querySelectorAll('.nrbc-filter, .core-filter, .sector-filter').forEach(cb => {
    cb.addEventListener('change', applyFiltersAndSort);
  });

  searchBox.addEventListener('input', applyFiltersAndSort);
  sortSelect.addEventListener('change', applyFiltersAndSort);

  document.getElementById('clearFiltersBtn').addEventListener('click', () => {
    document.querySelectorAll('.nrbc-filter, .core-filter, .sector-filter').forEach(cb => {
      cb.checked = false;
    });
    searchBox.value = '';
    sortSelect.value = 'default';
    applyFiltersAndSort();
  });

  document.getElementById('exportJsonBtn').addEventListener('click', () => {
    const blob = new Blob([JSON.stringify(filtered, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'canonical-values.json';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  });

  document.getElementById('exportCsvBtn').addEventListener('click', () => {
    const headers = Object.keys(filtered[0]).join(',');
    const rows = filtered.map(obj => Object.values(obj).map(v =>
      Array.isArray(v) ? `"${v.join('; ')}"` : `"${String(v).replace(/"/g, '""')}"`
    ).join(','));
    const csv = [headers, ...rows].join('\n');
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'canonical-values.csv';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  });

  render(values);
}
document.addEventListener('DOMContentLoaded', loadValues);
</script>
